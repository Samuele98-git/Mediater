<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= APP_NAME %></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --accent: <%= ACCENT_COLOR %>; --bg: #141414; }
        body { margin: 0; background: var(--bg); color: white; font-family: sans-serif; overflow-x: hidden; }
        .nav { position: fixed; top: 0; width: 100%; height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 4%; background: linear-gradient(180deg, rgba(0,0,0,0.8), transparent); z-index: 100; box-sizing: border-box; }
        .logo { font-size: 1.5rem; font-weight: bold; color: var(--accent); text-decoration: none; }
        .avatar { width: 32px; height: 32px; border-radius: 4px; border: 1px solid transparent; transition: 0.2s; }
        .avatar:hover { border-color: white; }
        
        .hero { height: 75vh; background-size: cover; background-position: center; display: flex; align-items: center; padding: 0 4%; position: relative; }
        .hero::after { content:''; position: absolute; inset: 0; background: linear-gradient(0deg, var(--bg) 0%, transparent 50%); }
        .hero-content { position: relative; z-index: 10; max-width: 600px; padding-top: 50px; }
        .hero-title { font-size: 3.5rem; font-weight: 800; margin-bottom: 20px; text-shadow: 2px 2px 10px black; }
        .btn { background: white; color: black; padding: 12px 30px; border-radius: 4px; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; transition: 0.2s; }
        .btn:hover { opacity: 0.9; transform: scale(1.05); }

        .row { margin: 20px 0 30px 4%; position: relative; z-index: 20; }
        .row-title { font-size: 1.2rem; font-weight: 600; color: #e5e5e5; margin-bottom: 10px; }
        .slider { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 20px; scroll-behavior: smooth; }
        .slider::-webkit-scrollbar { display: none; }
        .card { flex: 0 0 240px; height: 135px; border-radius: 4px; background: #222; overflow: hidden; transition: transform 0.3s; cursor: pointer; }
        .card:hover { transform: scale(1.1); z-index: 50; box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        .card img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body>
    <div class="nav">
        <a href="/" class="logo"><%= APP_NAME %></a>
        <div style="display:flex; gap:15px; align-items:center;">
            <% if (user && user.role === 'admin') { %>
                <a href="/admin" style="color:white; text-decoration:none; border:1px solid white; padding:5px 10px; border-radius:4px; font-size:0.8rem;">DASHBOARD</a>
            <% } %>
            <a href="/profile">
                <img src="<%= user && user.avatar ? user.avatar : 'https://ui-avatars.com/api/?background=333&color=fff&name=' + (user ? user.username : 'U') %>" class="avatar">
            </a>
        </div>
    </div>

    <% if (hero) { %>
    <div class="hero" style="background-image: url('<%= hero.thumbnail %>');">
        <div class="hero-content">
            <h1 class="hero-title"><%= hero.title %></h1>
            <a href="/watch/<%= hero.id %>" class="btn"><i class="fas fa-play"></i> Watch Now</a>
        </div>
    </div>
    <% } else { %>
        <div style="height:80vh; display:flex; align-items:center; justify-content:center; color:#666;">Library is empty.</div>
    <% } %>

    <div style="margin-top: -100px;">
        <% if (rows) { %>
            <% Object.keys(rows).forEach(cat => { %>
                <div class="row">
                    <div class="row-title"><%= cat %></div>
                    <div class="slider">
                        <% rows[cat].forEach(m => { %>
                            <div class="card" onclick="location.href='/watch/<%= m.id %>'">
                                <img src="<%= m.thumbnail %>" loading="lazy">
                            </div>
                        <% }) %>
                    </div>
                </div>
            <% }) %>
        <% } %>
    </div>
</body>
</html>